---
import MobileNav from '@/components/react/MobileNav';

interface Props {
  transparent?: boolean;
}

const { transparent = false } = Astro.props;

const navLinks = [
  { label: 'Features', href: '#features' },
  { label: 'How It Works', href: '#how-it-works' },
];

const compareLinks = [
  { label: 'vs Voicenotes', href: '/vs/voicenotes' },
  { label: 'vs Notion', href: '/vs/notion' },
];

const useCaseLinks = [
  { label: 'For ADHD', href: '/for/adhd' },
  { label: 'For Creatives', href: '/for/creatives' },
];
---

<header
  class:list={[
    'fixed top-0 left-0 right-0 z-50 transition-all duration-300',
    transparent ? 'bg-transparent' : 'bg-bg-base/80 backdrop-blur-xl border-b border-border/50',
  ]}
  id="main-nav"
>
  <nav class="container-wide">
    <div class="flex h-16 items-center justify-between lg:h-20">
      <!-- Logo -->
      <a href="/" class="flex items-center gap-3 group">
        <img
          src="/assets/AppIcon.png"
          alt="Thoughtmarks"
          class="h-10 w-10 rounded-xl transition-transform duration-300 group-hover:scale-105"
          width="40"
          height="40"
        />
        <span class="text-lg font-bold text-text-primary tracking-tight hidden sm:block">
          THOUGHTMARKS
        </span>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden lg:flex lg:items-center lg:gap-8">
        <ul class="flex items-center gap-6">
          {navLinks.map((link) => (
            <li>
              <a
                href={link.href}
                class="text-text-secondary hover:text-text-primary transition-colors 
                       font-medium text-sm tracking-wide"
              >
                {link.label}
              </a>
            </li>
          ))}
          
          <!-- Compare Dropdown -->
          <li class="relative group">
            <button
              class="text-text-secondary hover:text-text-primary transition-colors 
                     font-medium text-sm tracking-wide flex items-center gap-1"
            >
              Compare
              <svg class="w-4 h-4 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 
                        group-hover:visible transition-all duration-200">
              <div class="bg-bg-elevated border border-border rounded-xl shadow-card p-2 min-w-[160px]">
                {compareLinks.map((link) => (
                  <a
                    href={link.href}
                    class="block px-4 py-2 text-sm text-text-secondary hover:text-text-primary 
                           hover:bg-bg-surface rounded-lg transition-colors"
                  >
                    {link.label}
                  </a>
                ))}
              </div>
            </div>
          </li>

          <!-- Use Cases Dropdown -->
          <li class="relative group">
            <button
              class="text-text-secondary hover:text-text-primary transition-colors 
                     font-medium text-sm tracking-wide flex items-center gap-1"
            >
              Use Cases
              <svg class="w-4 h-4 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 
                        group-hover:visible transition-all duration-200">
              <div class="bg-bg-elevated border border-border rounded-xl shadow-card p-2 min-w-[160px]">
                {useCaseLinks.map((link) => (
                  <a
                    href={link.href}
                    class="block px-4 py-2 text-sm text-text-secondary hover:text-text-primary 
                           hover:bg-bg-surface rounded-lg transition-colors"
                  >
                    {link.label}
                  </a>
                ))}
              </div>
            </div>
          </li>

          <li>
            <a
              href="/support"
              class="text-text-secondary hover:text-text-primary transition-colors 
                     font-medium text-sm tracking-wide"
            >
              Support
            </a>
          </li>
        </ul>

        <a href="#download" class="btn-primary text-sm">
          Get the App
        </a>
      </div>

      <!-- Mobile Navigation -->
      <MobileNav client:load />
    </div>
  </nav>
</header>

<script>
  // Add background on scroll
  const nav = document.getElementById('main-nav');
  
  const handleScroll = () => {
    if (!nav) return;
    
    if (window.scrollY > 50) {
      nav.classList.remove('bg-transparent');
      nav.classList.add('bg-bg-base/80', 'backdrop-blur-xl', 'border-b', 'border-border/50');
    } else {
      nav.classList.add('bg-transparent');
      nav.classList.remove('bg-bg-base/80', 'backdrop-blur-xl', 'border-b', 'border-border/50');
    }
  };

  // Initial check
  handleScroll();
  
  // Listen for scroll
  window.addEventListener('scroll', handleScroll, { passive: true });
</script>

